"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),t=e=>null!=e,n=e=>"function"==typeof e,o=e=>null!==e&&"object"==typeof e,a=e=>"number"==typeof e||/^\d+(\.\d+)?$/.test(e);function l(){}const i=Object.assign,r="undefined"!=typeof window;function c(e,t){const n=t.split(".");let a=e;return n.forEach((e=>{var t;a=o(a)&&null!=(t=a[e])?t:""})),a}function s(e,t,n){return t.reduce(((t,o)=>(n&&void 0===e[o]||(t[o]=e[o]),t)),{})}const u=(e,t)=>JSON.stringify(e)===JSON.stringify(t),d=[Number,String],v={type:Boolean,default:!0},p=e=>({type:e,required:!0}),f=()=>({type:Array,default:()=>[]}),h=e=>({type:d,default:e}),m=e=>({type:String,default:e});var g="undefined"!=typeof window;function b(e){return g?requestAnimationFrame(e):-1}function w(e){b((()=>b(e)))}var y,x,C=(e,t)=>({top:0,left:0,right:e,bottom:t,width:e,height:t}),N=t=>{const n=e.unref(t);if(n===window){const e=n.innerWidth,t=n.innerHeight;return C(e,t)}return(null==n?void 0:n.getBoundingClientRect)?n.getBoundingClientRect():C(0,0)};function k(t){const n=e.inject(t,null);if(n){const t=e.getCurrentInstance(),{link:o,unlink:a,internalChildren:l}=n;o(t),e.onUnmounted((()=>a(t)));return{parent:n,index:e.computed((()=>l.indexOf(t)))}}return{parent:null,index:e.ref(-1)}}function V(t,n,o){const a=function(t){const n=[],o=t=>{Array.isArray(t)&&t.forEach((t=>{var a;e.isVNode(t)&&(n.push(t),(null==(a=t.component)?void 0:a.subTree)&&(n.push(t.component.subTree),o(t.component.subTree.children)),t.children&&o(t.children))}))};return o(t),n}(t.subTree.children);o.sort(((e,t)=>a.indexOf(e.vnode)-a.indexOf(t.vnode)));const l=o.map((e=>e.proxy));n.sort(((e,t)=>l.indexOf(e)-l.indexOf(t)))}function S(t){const n=e.reactive([]),o=e.reactive([]),a=e.getCurrentInstance();return{children:n,linkChildren:l=>{e.provide(t,Object.assign({link:e=>{e.proxy&&(o.push(e),n.push(e.proxy),V(a,n,o))},unlink:e=>{const t=o.indexOf(e);n.splice(t,1),o.splice(t,1)},children:n,internalChildren:o},l))}}}function T(t){let n;e.onMounted((()=>{t(),e.nextTick((()=>{n=!0}))})),e.onActivated((()=>{n&&t()}))}function $(t,n,o={}){if(!g)return;const{target:a=window,passive:l=!1,capture:i=!1}=o;let r;const c=o=>{const a=e.unref(o);a&&!r&&(a.addEventListener(t,n,{capture:i,passive:l}),r=!0)},s=o=>{const a=e.unref(o);a&&r&&(a.removeEventListener(t,n,i),r=!1)};e.onUnmounted((()=>s(a))),e.onDeactivated((()=>s(a))),T((()=>c(a))),e.isRef(a)&&e.watch(a,((e,t)=>{s(t),c(e)}))}var B,O=/scroll|auto|overlay/i,I=g?window:void 0;function z(e){return"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType}function M(t,n=I){const o=e.ref();return e.onMounted((()=>{t.value&&(o.value=function(e,t=I){let n=e;for(;n&&n!==t&&z(n);){const{overflowY:e}=window.getComputedStyle(n);if(O.test(e))return n;n=n.parentNode}return t}(t.value,n))})),o}function A(e){const t="scrollTop"in e?e.scrollTop:e.pageYOffset;return Math.max(t,0)}function E(e,t){"scrollTop"in e?e.scrollTop=t:e.scrollTo(e.scrollX,t)}function H(e,t){if(e===window)return 0;const n=t?A(t):window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;return N(e).top+n}r&&/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase());function D(e,t){("boolean"!=typeof e.cancelable||e.cancelable)&&e.preventDefault(),t&&(e=>{e.stopPropagation()})(e)}function P(t){const n=e.unref(t);if(!n)return!1;const o=window.getComputedStyle(n),a="none"===o.display,l=null===n.offsetParent&&"fixed"!==o.position;return a||l}const{width:R,height:L}=function(){if(!y&&(y=e.ref(0),x=e.ref(0),g)){const e=()=>{y.value=window.innerWidth,x.value=window.innerHeight};e(),window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",e,{passive:!0})}return{width:y,height:x}}();function j(e){if(t(e))return a(e)?`${e}px`:String(e)}let Y;function X(e){return+(e=e.replace(/rem/g,""))*function(){if(!Y){const e=document.documentElement,t=e.style.fontSize||window.getComputedStyle(e).fontSize;Y=parseFloat(t)}return Y}()}function W(e){if("number"==typeof e)return e;if(r){if(e.includes("rem"))return X(e);if(e.includes("vw"))return function(e){return+(e=e.replace(/vw/g,""))*R.value/100}(e);if(e.includes("vh"))return function(e){return+(e=e.replace(/vh/g,""))*L.value/100}(e)}return parseFloat(e)}const F=/-(\w)/g,Z=e=>e.replace(F,((e,t)=>t.toUpperCase())),_=(e,t,n)=>Math.min(Math.max(e,t),n),{hasOwnProperty:U}=Object.prototype;function q(e,n){return Object.keys(n).forEach((a=>{!function(e,n,a){const l=n[a];t(l)&&(U.call(e,a)&&o(l)?e[a]=q(Object(e[a]),l):e[a]=l)}(e,n,a)})),e}const J=e.ref("zh-CN"),G=e.reactive({"zh-CN":{name:"姓名",tel:"电话",save:"保存",confirm:"确认",cancel:"取消",delete:"删除",loading:"加载中...",noCoupon:"暂无优惠券",nameEmpty:"请填写姓名",addContact:"添加联系人",telInvalid:"请填写正确的电话",vanCalendar:{end:"结束",start:"开始",title:"日期选择",weekdays:["日","一","二","三","四","五","六"],monthTitle:(e,t)=>`${e}年${t}月`,rangePrompt:e=>`最多选择 ${e} 天`},vanCascader:{select:"请选择"},vanPagination:{prev:"上一页",next:"下一页"},vanPullRefresh:{pulling:"下拉即可刷新...",loosing:"释放即可刷新..."},vanSubmitBar:{label:"合计:"},vanCoupon:{unlimited:"无门槛",discount:e=>`${e}折`,condition:e=>`满${e}元可用`},vanCouponCell:{title:"优惠券",count:e=>`${e}张可用`},vanCouponList:{exchange:"兑换",close:"不使用",enable:"可用",disabled:"不可用",placeholder:"输入优惠码"},vanAddressEdit:{area:"地区",areaEmpty:"请选择地区",addressEmpty:"请填写详细地址",addressDetail:"详细地址",defaultAddress:"设为默认收货地址"},vanAddressList:{add:"新增地址"}}});var K={messages:()=>G[J.value],use(e,t){J.value=e,this.add({[e]:t})},add(e={}){q(G,e)}};function Q(e){const t=Z(e)+".";return(e,...o)=>{const a=K.messages(),l=c(a,t+e)||c(a,e);return n(l)?l(...o):l}}function ee(e,t){return t?"string"==typeof t?` ${e}--${t}`:Array.isArray(t)?t.reduce(((t,n)=>t+ee(e,n)),""):Object.keys(t).reduce(((n,o)=>n+(t[o]?ee(e,o):"")),""):""}function te(e){return(t,n)=>(t&&"string"!=typeof t&&(n=t,t=""),`${t=t?`${e}__${t}`:e}${ee(t,n)}`)}function ne(e){const t=`van-${e}`;return[t,te(t),Q(t)]}function oe(e,{args:t=[],done:a,canceled:i}){if(e){const c=e.apply(null,t);o(r=c)&&n(r.then)&&n(r.catch)?c.then((e=>{e?a():i&&i()})).catch(l):c?a():i&&i()}else a();var r}function ae(e){return e.install=t=>{const{name:n}=e;n&&(t.component(n,e),t.component(Z(`-${n}`),e))},e}function le(e){const t=`van-${e}`;return console.log("%c 🍔 prefixedName","color:#e41a6a",t),[t,te(t),Q(t)]}const[ie,re,ce]=le("picker"),se=e=>e.find((e=>!e.disabled))||e[0];function ue(e,t){for(let n=t=_(t,0,e.length);n<e.length;n++)if(!e[n].disabled)return n;for(let n=t-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const de=(e,t,n)=>void 0!==t&&!!e.find((e=>e[n.value]===t));function ve(e,t,n){const o=e.findIndex((e=>e[n.value]===t));return e[ue(e,o)]}function pe(t){const n=e.getCurrentInstance();n&&i(n.proxy,t)}const[fe,he]=ne("loading"),me=Array(12).fill(null).map(((t,n)=>e.createVNode("i",{class:he("line",String(n+1))},null))),ge=e.createVNode("svg",{class:he("circular"),viewBox:"25 25 50 50"},[e.createVNode("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),be={size:d,type:m("circular"),color:String,vertical:Boolean,textSize:d,textColor:String};const we=ae(e.defineComponent({name:fe,props:be,setup(n,{slots:o}){const a=e.computed((()=>i({color:n.color},function(e){if(t(e)){if(Array.isArray(e))return{width:j(e[0]),height:j(e[1])};const t=j(e);return{width:t,height:t}}}(n.size)))),l=()=>{var t;if(o.default)return e.createVNode("span",{class:he("text"),style:{fontSize:j(n.textSize),color:null!=(t=n.textColor)?t:n.color}},[o.default()])};return()=>{const{type:t,vertical:o}=n;return e.createVNode("div",{class:he([t,{vertical:o}]),"aria-live":"polite","aria-busy":!0},[e.createVNode("span",{class:he("spinner",t),style:a.value},["spinner"===t?me:ge]),l()])}}}));function ye(){const t=e.ref(0),n=e.ref(0),o=e.ref(0),a=e.ref(0),l=e.ref(0),i=e.ref(0),r=e.ref(""),c=()=>{o.value=0,a.value=0,l.value=0,i.value=0,r.value=""};return{move:e=>{const c=e.touches[0];o.value=(c.clientX<0?0:c.clientX)-t.value,a.value=c.clientY-n.value,l.value=Math.abs(o.value),i.value=Math.abs(a.value);var s,u;(!r.value||l.value<10&&i.value<10)&&(r.value=(s=l.value,u=i.value,s>u?"horizontal":u>s?"vertical":""))},start:e=>{c(),t.value=e.touches[0].clientX,n.value=e.touches[0].clientY},reset:c,startX:t,startY:n,deltaX:o,deltaY:a,offsetX:l,offsetY:i,direction:r,isVertical:()=>"vertical"===r.value,isHorizontal:()=>"horizontal"===r.value}}const[xe,Ce]=le("picker-column"),Ne=Symbol(xe),ke=e.defineComponent({name:xe,props:{value:d,fields:p(Object),options:f(),readonly:Boolean,allowHtml:Boolean,optionHeight:p(Number),swipeDuration:p(d),visibleOptionNum:p(d)},emits:["change","clickOption"],setup(t,{emit:n,slots:o}){let a,l,i,r,c;const s=e.ref(),u=e.ref(),d=e.ref(0),v=e.ref(0),p=ye(),f=()=>t.options.length,h=()=>t.optionHeight*(+t.visibleOptionNum-1)/2,m=e=>{const o=ue(t.options,e),l=-o*t.optionHeight,i=()=>{const e=t.options[o][t.fields.value];e!==t.value&&n("change",e)};a&&l!==d.value?c=i:i(),d.value=l},g=e=>_(Math.round(-e/t.optionHeight),0,f()-1),b=()=>{a=!1,v.value=0,c&&(c(),c=null)},w=e=>{if(!t.readonly){if(p.start(e),a){const e=function(e){const{transform:t}=window.getComputedStyle(e),n=t.slice(7,t.length-1).split(", ")[5];return Number(n)}(u.value);d.value=Math.min(0,e-h())}v.value=0,l=d.value,i=Date.now(),r=l,c=null}},y=()=>{if(t.readonly)return;const e=d.value-r,n=Date.now()-i;if(n<300&&Math.abs(e)>15)return void((e,n)=>{const o=Math.abs(e/n);e=d.value+o/.003*(e<0?-1:1);const a=g(e);v.value=+t.swipeDuration,m(a)})(e,n);const o=g(d.value);v.value=200,m(o),setTimeout((()=>{a=!1}),0)},x=()=>{const l={height:`${t.optionHeight}px`};return t.options.map(((i,r)=>{const s=i[t.fields.text],{disabled:u}=i,d=i[t.fields.value],p={role:"button",style:l,tabindex:u?-1:0,class:[Ce("item",{disabled:u,selected:d===t.value}),i.className],onClick:()=>(e=>{a||t.readonly||(c=null,v.value=200,m(e),n("clickOption",t.options[e]))})(r)},f={class:"van-ellipsis",[t.allowHtml?"innerHTML":"textContent"]:s};return e.createVNode("li",p,[o.option?o.option(i):e.createVNode("div",f,null)])}))};return k(Ne),pe({stopMomentum:b}),e.watchEffect((()=>{const e=t.options.findIndex((e=>e[t.fields.value]===t.value)),n=-ue(t.options,e)*t.optionHeight;d.value=n})),$("touchmove",(e=>{if(t.readonly)return;p.move(e),p.isVertical()&&(a=!0,D(e,!0)),d.value=_(l+p.deltaY.value,-f()*t.optionHeight,t.optionHeight);const n=Date.now();n-i>300&&(i=n,r=d.value)}),{target:s}),()=>e.createVNode("div",{ref:s,class:Ce(),onTouchstartPassive:w,onTouchend:y,onTouchcancel:y},[e.createVNode("ul",{ref:u,style:{transform:`translate3d(0, ${d.value+h()}px, 0)`,transitionDuration:`${v.value}ms`,transitionProperty:v.value?"all":"none"},class:Ce("wrapper"),onTransitionend:b},[x()])])}}),[Ve]=le("picker-toolbar"),Se={title:String,cancelButtonText:String,confirmButtonText:String},Te=["cancel","confirm","title","toolbar"],$e=Object.keys(Se),Be=e.defineComponent({name:Ve,props:Se,emits:["confirm","cancel"],setup(t,{emit:n,slots:o}){const a=()=>n("cancel"),l=()=>n("confirm"),i=()=>{const n=t.cancelButtonText||ce("cancel");return e.createVNode("button",{type:"button",class:[re("cancel"),"van-haptics-feedback"],onClick:a},[o.cancel?o.cancel():n])},r=()=>{const n=t.confirmButtonText||ce("confirm");return e.createVNode("button",{type:"button",class:[re("confirm"),"van-haptics-feedback"],onClick:l},[o.confirm?o.confirm():n])};return()=>e.createVNode("div",{class:re("toolbar")},[o.toolbar?o.toolbar():[i(),o.title?o.title():t.title?e.createVNode("div",{class:[re("title"),"van-ellipsis"]},[t.title]):void 0,r()]])}});let Oe=0;function Ie(){const t=e.getCurrentInstance(),{name:n="unknown"}=(null==t?void 0:t.type)||{};return"test"===process.env.NODE_ENV?n:`${n}-${++Oe}`}const ze={to:[String,Object],url:String,replace:Boolean};const Me=Symbol();function Ae(t){const n=e.inject(Me,null);n&&e.watch(n,(e=>{e&&t()}))}const[Ee,He]=ne("sticky"),De={zIndex:d,position:m("top"),container:Object,offsetTop:h(0),offsetBottom:h(0)};const Pe=ae(e.defineComponent({name:Ee,props:De,emits:["scroll","change"],setup(t,{emit:n,slots:o}){const a=e.ref(),l=M(a),c=e.reactive({fixed:!1,width:0,height:0,transform:0}),s=e.computed((()=>W("top"===t.position?t.offsetTop:t.offsetBottom))),u=e.computed((()=>{const{fixed:e,height:t,width:n}=c;if(e)return{width:`${n}px`,height:`${t}px`}})),d=e.computed((()=>{if(!c.fixed)return;const e=i(function(e){const t={};return void 0!==e&&(t.zIndex=+e),t}(t.zIndex),{width:`${c.width}px`,height:`${c.height}px`,[t.position]:`${s.value}px`});return c.transform&&(e.transform=`translate3d(0, ${c.transform}px, 0)`),e})),v=()=>{if(!a.value||P(a))return;const{container:e,position:o}=t,l=N(a),i=A(window);if(c.width=l.width,c.height=l.height,"top"===o)if(e){const t=N(e),n=t.bottom-s.value-c.height;c.fixed=s.value>l.top&&t.bottom>0,c.transform=n<0?n:0}else c.fixed=s.value>l.top;else{const{clientHeight:t}=document.documentElement;if(e){const n=N(e),o=t-n.top-s.value-c.height;c.fixed=t-s.value<l.bottom&&t>n.top,c.transform=o<0?-o:0}else c.fixed=t-s.value<l.bottom}(e=>{n("scroll",{scrollTop:e,isFixed:c.fixed})})(i)};return e.watch((()=>c.fixed),(e=>n("change",e))),$("scroll",v,{target:l,passive:!0}),function(t,n){if(!r||!window.IntersectionObserver)return;const o=new IntersectionObserver((e=>{n(e[0].intersectionRatio>0)}),{root:document.body}),a=()=>{t.value&&o.unobserve(t.value)};e.onDeactivated(a),e.onBeforeUnmount(a),T((()=>{t.value&&o.observe(t.value)}))}(a,v),()=>{var t;return e.createVNode("div",{ref:a,style:u.value},[e.createVNode("div",{class:He({fixed:c.fixed}),style:d.value},[null==(t=o.default)?void 0:t.call(o)])])}}})),[Re,Le]=ne("badge"),je={dot:Boolean,max:d,tag:m("div"),color:String,offset:Array,content:d,showZero:v,position:m("top-right")};const Ye=ae(e.defineComponent({name:Re,props:je,setup(n,{slots:o}){const l=()=>{if(o.content)return!0;const{content:e,showZero:a}=n;return t(e)&&""!==e&&(a||0!==e&&"0"!==e)},i=()=>{const{dot:e,max:i,content:r}=n;if(!e&&l())return o.content?o.content():t(i)&&a(r)&&+r>i?`${i}+`:r},r=e.computed((()=>{const e={background:n.color};if(n.offset){const[t,a]=n.offset;o.default?(e.top=j(a),e.right="number"==typeof t?j(-t):t.startsWith("-")?t.replace("-",""):`-${t}`):(e.marginTop=j(a),e.marginLeft=j(t))}return e})),c=()=>{if(l()||n.dot)return e.createVNode("div",{class:Le([n.position,{dot:n.dot,fixed:!!o.default}]),style:r.value},[i()])};return()=>{if(o.default){const{tag:t}=n;return e.createVNode(t,{class:Le("wrapper")},{default:()=>[o.default(),c()]})}return c()}}})),[Xe,We]=ne("tab");var Fe=e.defineComponent({name:Xe,props:{id:String,dot:Boolean,type:String,color:String,title:String,badge:d,shrink:Boolean,isActive:Boolean,disabled:Boolean,controls:String,scrollable:Boolean,activeColor:String,inactiveColor:String,showZeroBadge:v},setup(n,{slots:o}){const a=e.computed((()=>{const e={},{type:t,color:o,disabled:a,isActive:l,activeColor:i,inactiveColor:r}=n;o&&"card"===t&&(e.borderColor=o,a||(l?e.backgroundColor=o:e.color=o));const c=l?i:r;return c&&(e.color=c),e})),l=()=>{const a=e.createVNode("span",{class:We("text",{ellipsis:!n.scrollable})},[o.title?o.title():n.title]);return n.dot||t(n.badge)&&""!==n.badge?e.createVNode(Ye,{dot:n.dot,content:n.badge,showZero:n.showZeroBadge},{default:()=>[a]}):a};return()=>e.createVNode("div",{id:n.id,role:"tab",class:[We([n.type,{grow:n.scrollable&&!n.shrink,shrink:n.shrink,active:n.isActive,disabled:n.disabled}])],style:a.value,tabindex:n.disabled?void 0:n.isActive?0:-1,"aria-selected":n.isActive,"aria-disabled":n.disabled||void 0,"aria-controls":n.controls},[l()])}});const[Ze,_e]=ne("swipe"),Ue={loop:v,width:d,height:d,vertical:Boolean,autoplay:h(0),duration:h(500),touchable:v,lazyRender:Boolean,initialSwipe:h(0),indicatorColor:String,showIndicators:v,stopPropagation:v},qe=Symbol(Ze);const Je=ae(e.defineComponent({name:Ze,props:Ue,emits:["change"],setup(t,{emit:n,slots:o}){const a=e.ref(),l=e.ref(),i=e.reactive({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),r=ye(),{children:c,linkChildren:s}=S(qe),u=e.computed((()=>c.length)),d=e.computed((()=>i[t.vertical?"height":"width"])),v=e.computed((()=>t.vertical?r.deltaY.value:r.deltaX.value)),p=e.computed((()=>{if(i.rect){return(t.vertical?i.rect.height:i.rect.width)-d.value*u.value}return 0})),f=e.computed((()=>Math.ceil(Math.abs(p.value)/d.value))),h=e.computed((()=>u.value*d.value)),m=e.computed((()=>(i.active+u.value)%u.value)),b=e.computed((()=>{const e=t.vertical?"vertical":"horizontal";return r.direction.value===e})),y=e.computed((()=>{const e={transitionDuration:`${i.swiping?0:t.duration}ms`,transform:`translate${t.vertical?"Y":"X"}(${i.offset}px)`};if(d.value){const n=t.vertical?"height":"width",o=t.vertical?"width":"height";e[n]=`${h.value}px`,e[o]=t[o]?`${t[o]}px`:""}return e})),x=(e,n=0)=>{let o=e*d.value;t.loop||(o=Math.min(o,-p.value));let a=n-o;return t.loop||(a=_(a,p.value,0)),a},C=({pace:e=0,offset:o=0,emitChange:a})=>{if(u.value<=1)return;const{active:l}=i,r=(e=>{const{active:n}=i;return e?t.loop?_(n+e,-1,u.value):_(n+e,0,f.value):n})(e),s=x(r,o);if(t.loop){if(c[0]&&s!==p.value){const e=s<p.value;c[0].setOffset(e?h.value:0)}if(c[u.value-1]&&0!==s){const e=s>0;c[u.value-1].setOffset(e?-h.value:0)}}i.active=r,i.offset=s,a&&r!==l&&n("change",m.value)},N=()=>{i.swiping=!0,i.active<=-1?C({pace:u.value}):i.active>=u.value&&C({pace:-u.value})},k=()=>{N(),r.reset(),w((()=>{i.swiping=!1,C({pace:1,emitChange:!0})}))};let V;const T=()=>clearTimeout(V),O=()=>{T(),t.autoplay>0&&u.value>1&&(V=setTimeout((()=>{k(),O()}),+t.autoplay))},I=(n=+t.initialSwipe)=>{if(!a.value)return;const o=()=>{var e,o;if(!P(a)){const n={width:a.value.offsetWidth,height:a.value.offsetHeight};i.rect=n,i.width=+(null!=(e=t.width)?e:n.width),i.height=+(null!=(o=t.height)?o:n.height)}u.value&&(n=Math.min(u.value-1,n)),i.active=n,i.swiping=!0,i.offset=x(n),c.forEach((e=>{e.setOffset(0)})),O()};P(a)?e.nextTick().then(o):o()},z=()=>I(i.active);let M;const A=e=>{t.touchable&&(r.start(e),M=Date.now(),T(),N())},E=()=>{if(!t.touchable||!i.swiping)return;const e=Date.now()-M,n=v.value/e;if((Math.abs(n)>.25||Math.abs(v.value)>d.value/2)&&b.value){const e=t.vertical?r.offsetY.value:r.offsetX.value;let n=0;n=t.loop?e>0?v.value>0?-1:1:0:-Math[v.value>0?"ceil":"floor"](v.value/d.value),C({pace:n,emitChange:!0})}else v.value&&C({pace:0});i.swiping=!1,O()},H=(n,o)=>{const a=o===m.value,l=a?{backgroundColor:t.indicatorColor}:void 0;return e.createVNode("i",{style:l,class:_e("indicator",{active:a})},null)};return pe({prev:()=>{N(),r.reset(),w((()=>{i.swiping=!1,C({pace:-1,emitChange:!0})}))},next:k,state:i,resize:z,swipeTo:(e,n={})=>{N(),r.reset(),w((()=>{let o;o=t.loop&&e===u.value?0===i.active?0:e:e%u.value,n.immediate?w((()=>{i.swiping=!1})):i.swiping=!1,C({pace:o-i.active,emitChange:!0})}))}}),s({size:d,props:t,count:u,activeIndicator:m}),e.watch((()=>t.initialSwipe),(e=>I(+e))),e.watch(u,(()=>I(i.active))),e.watch((()=>t.autoplay),O),e.watch([R,L],z),e.watch(function(){if(!B&&(B=e.ref("visible"),g)){const e=()=>{B.value=document.hidden?"hidden":"visible"};e(),window.addEventListener("visibilitychange",e)}return B}(),(e=>{"visible"===e?O():T()})),e.onMounted(I),e.onActivated((()=>I(i.active))),Ae((()=>I(i.active))),e.onDeactivated(T),e.onBeforeUnmount(T),$("touchmove",(e=>{if(t.touchable&&i.swiping&&(r.move(e),b.value)){!t.loop&&(0===i.active&&v.value>0||i.active===u.value-1&&v.value<0)||(D(e,t.stopPropagation),C({offset:v.value}))}}),{target:l}),()=>{var n;return e.createVNode("div",{ref:a,class:_e()},[e.createVNode("div",{ref:l,style:y.value,class:_e("track",{vertical:t.vertical}),onTouchstartPassive:A,onTouchend:E,onTouchcancel:E},[null==(n=o.default)?void 0:n.call(o)]),o.indicator?o.indicator({active:m.value,total:u.value}):t.showIndicators&&u.value>1?e.createVNode("div",{class:_e("indicators",{vertical:t.vertical})},[Array(u.value).fill("").map(H)]):void 0])}}})),[Ge,Ke]=ne("tabs");var Qe=e.defineComponent({name:Ge,props:{count:p(Number),inited:Boolean,animated:Boolean,duration:p(d),swipeable:Boolean,lazyRender:Boolean,currentIndex:p(Number)},emits:["change"],setup(t,{emit:n,slots:o}){const a=e.ref(),l=e=>n("change",e),i=()=>{var n;const i=null==(n=o.default)?void 0:n.call(o);return t.animated||t.swipeable?e.createVNode(Je,{ref:a,loop:!1,class:Ke("track"),duration:1e3*+t.duration,touchable:t.swipeable,lazyRender:t.lazyRender,showIndicators:!1,onChange:l},{default:()=>[i]}):i},r=e=>{const n=a.value;n&&n.state.active!==e&&n.swipeTo(e,{immediate:!t.inited})};return e.watch((()=>t.currentIndex),r),e.onMounted((()=>{r(t.currentIndex)})),pe({swipeRef:a}),()=>e.createVNode("div",{class:Ke("content",{animated:t.animated||t.swipeable})},[i()])}});const[et,tt]=ne("tabs"),nt={type:m("line"),color:String,border:Boolean,sticky:Boolean,shrink:Boolean,active:h(0),duration:h(.3),animated:Boolean,ellipsis:v,swipeable:Boolean,scrollspy:Boolean,offsetTop:h(0),background:String,lazyRender:v,lineWidth:d,lineHeight:d,beforeChange:Function,swipeThreshold:h(5),titleActiveColor:String,titleInactiveColor:String},ot=Symbol(et);var at=e.defineComponent({name:et,props:nt,emits:["change","scroll","rendered","clickTab","update:active"],setup(n,{emit:o,slots:a}){let l,i,r;const c=e.ref(),u=e.ref(),d=e.ref(),v=e.ref(),p=Ie(),f=M(c),[h,m]=function(){const t=e.ref([]),n=[];return e.onBeforeUpdate((()=>{t.value=[]})),[t,e=>(n[e]||(n[e]=n=>{t.value[e]=n}),n[e])]}(),{children:g,linkChildren:w}=S(ot),y=e.reactive({inited:!1,position:"",lineStyle:{},currentIndex:-1}),x=e.computed((()=>g.length>n.swipeThreshold||!n.ellipsis||n.shrink)),C=e.computed((()=>({borderColor:n.color,background:n.background}))),k=(e,t)=>{var n;return null!=(n=e.name)?n:t},V=e.computed((()=>{const e=g[y.currentIndex];if(e)return k(e,y.currentIndex)})),B=e.computed((()=>W(n.offsetTop))),O=e.computed((()=>n.sticky?B.value+l:0)),I=e=>{const t=u.value,o=h.value;if(!(x.value&&t&&o&&o[y.currentIndex]))return;const a=o[y.currentIndex].$el;!function(e,t,n){let o=0;const a=e.scrollLeft,l=0===n?1:Math.round(1e3*n/16);!function n(){e.scrollLeft+=(t-a)/l,++o<l&&b(n)}()}(t,a.offsetLeft-(t.offsetWidth-a.offsetWidth)/2,e?0:+n.duration)},z=()=>{const o=y.inited;e.nextTick((()=>{const e=h.value;if(!e||!e[y.currentIndex]||"line"!==n.type||P(c.value))return;const a=e[y.currentIndex].$el,{lineWidth:l,lineHeight:i}=n,r=a.offsetLeft+a.offsetWidth/2,s={width:j(l),backgroundColor:n.color,transform:`translateX(${r}px) translateX(-50%)`};if(o&&(s.transitionDuration=`${n.duration}s`),t(i)){const e=j(i);s.height=e,s.borderRadius=e}y.lineStyle=s}))},D=(e,a)=>{const l=(e=>{const t=e<y.currentIndex?-1:1;for(;e>=0&&e<g.length;){if(!g[e].disabled)return e;e+=t}})(e);if(!t(l))return;const i=g[l],s=k(i,l),u=null!==y.currentIndex;var d;y.currentIndex=l,s!==n.active&&(o("update:active",s),u&&o("change",s,i.title)),a||I(),z(),r&&!n.scrollspy&&(d=Math.ceil(H(c.value)-B.value),E(window,d),E(document.body,d))},L=(e,t)=>{const n=g.find(((t,n)=>k(t,n)===e)),o=n?g.indexOf(n):0;D(o,t)},Y=(e=!1)=>{if(n.scrollspy){const t=g[y.currentIndex].$el;if(t&&f.value){const o=H(t,f.value)-O.value;i=!0,function(e,t,n,o){let a=A(e);const l=a<t,i=0===n?1:Math.round(1e3*n/16),r=(t-a)/i;!function n(){a+=r,(l&&a>t||!l&&a<t)&&(a=t),E(e,a),l&&a<t||!l&&a>t?b(n):o&&b(o)}()}(f.value,o,e?0:+n.duration,(()=>{i=!1}))}}},X=(e,t,a)=>{const{title:l,disabled:i}=g[t],r=k(g[t],t);i||(oe(n.beforeChange,{args:[r],done:()=>{D(t),Y()}}),function({to:e,url:t,replace:n,$router:o}){e&&o?o[n?"replace":"push"](e):t&&(n?location.replace(t):location.href=t)}(e)),o("clickTab",{name:r,title:l,event:a,disabled:i})},F=e=>{r=e.isFixed,o("scroll",e)},Z=()=>{if("line"===n.type&&g.length)return e.createVNode("div",{class:tt("line"),style:y.lineStyle},null)},_=()=>{var t,o;const{type:l,border:i}=n;return e.createVNode("div",{ref:d,class:[tt("wrap"),{"van-hairline--top-bottom":"line"===l&&i}]},[e.createVNode("div",{ref:u,role:"tablist",class:tt("nav",[l,{shrink:n.shrink,complete:x.value}]),style:C.value,"aria-orientation":"horizontal"},[null==(t=a["nav-left"])?void 0:t.call(a),g.map(((t,o)=>e.createVNode(Fe,e.mergeProps({key:t.id,id:`${p}-${o}`,ref:m(o),type:n.type,color:n.color,style:t.titleStyle,class:t.titleClass,shrink:n.shrink,isActive:o===y.currentIndex,controls:t.id,scrollable:x.value,activeColor:n.titleActiveColor,inactiveColor:n.titleInactiveColor,onClick:e=>X(t,o,e)},s(t,["dot","badge","title","disabled","showZeroBadge"])),{title:t.$slots.title}))),Z(),null==(o=a["nav-right"])?void 0:o.call(a)])])};e.watch([()=>n.color,R],z),e.watch((()=>n.active),(e=>{e!==V.value&&L(e)})),e.watch((()=>g.length),(()=>{y.inited&&(L(n.active),z(),e.nextTick((()=>{I(!0)})))}));return pe({resize:()=>{z(),e.nextTick((()=>{var e,t;return null==(t=null==(e=v.value)?void 0:e.swipeRef.value)?void 0:t.resize()}))},scrollTo:t=>{e.nextTick((()=>{L(t),Y(!0)}))}}),e.onActivated(z),Ae(z),T((()=>{L(n.active,!0),e.nextTick((()=>{y.inited=!0,d.value&&(l=N(d.value).height),I(!0)}))})),$("scroll",(()=>{if(n.scrollspy&&!i){const e=(()=>{for(let e=0;e<g.length;e++){const{top:t}=N(g[e].$el);if(t>O.value)return 0===e?0:e-1}return g.length-1})();D(e)}}),{target:f,passive:!0}),w({id:p,props:n,setLine:z,onRendered:(e,t)=>o("rendered",e,t),currentName:V,scrollIntoView:I}),()=>{var t;return e.createVNode("div",{ref:c,class:tt([n.type])},[n.sticky?e.createVNode(Pe,{container:c.value,offsetTop:B.value,onScroll:F},{default:()=>{var e;return[_(),null==(e=a["nav-bottom"])?void 0:e.call(a)]}}):[_(),null==(t=a["nav-bottom"])?void 0:t.call(a)],e.createVNode(Qe,{ref:v,count:g.length,inited:y.inited,animated:n.animated,duration:n.duration,swipeable:n.swipeable,lazyRender:n.lazyRender,currentIndex:y.currentIndex,onChange:D},{default:()=>{var e;return[null==(e=a.default)?void 0:e.call(a)]}})])}}});const lt=Symbol(),[it,rt]=ne("swipe-item");const ct=ae(e.defineComponent({name:it,setup(t,{slots:n}){let o;const a=e.reactive({offset:0,inited:!1,mounted:!1}),{parent:l,index:i}=k(qe);if(!l)return void("production"!==process.env.NODE_ENV&&console.error("[Vant] <SwipeItem> must be a child component of <Swipe>."));const r=e.computed((()=>{const e={},{vertical:t}=l.props;return l.size.value&&(e[t?"height":"width"]=`${l.size.value}px`),a.offset&&(e.transform=`translate${t?"Y":"X"}(${a.offset}px)`),e})),c=e.computed((()=>{const{loop:e,lazyRender:t}=l.props;if(!t||o)return!0;if(!a.mounted)return!1;const n=l.activeIndicator.value,r=l.count.value-1,c=0===n&&e?r:n-1,s=n===r&&e?0:n+1;return o=i.value===n||i.value===c||i.value===s,o}));return e.onMounted((()=>{e.nextTick((()=>{a.mounted=!0}))})),pe({setOffset:e=>{a.offset=e}}),()=>{var t;return e.createVNode("div",{class:rt(),style:r.value},[c.value?null==(t=n.default)?void 0:t.call(n):null])}}})),[st,ut]=ne("tab"),dt=i({},ze,{dot:Boolean,name:d,badge:d,title:String,disabled:Boolean,titleClass:null,titleStyle:[String,Object],showZeroBadge:v});const vt=ae(e.defineComponent({name:st,props:dt,setup(t,{slots:n}){const o=Ie(),a=e.ref(!1),{parent:l,index:i}=k(ot);if(!l)return void("production"!==process.env.NODE_ENV&&console.error("[Vant] <Tab> must be a child component of <Tabs>."));const r=()=>{var e;return null!=(e=t.name)?e:i.value},c=e.computed((()=>{const n=r()===l.currentName.value;return n&&!a.value&&(a.value=!0,l.props.lazyRender&&e.nextTick((()=>{l.onRendered(r(),t.title)}))),n})),s=e.ref(!c.value);return e.watch(c,(e=>{e?s.value=!1:w((()=>{s.value=!0}))})),e.watch((()=>t.title),(()=>{l.setLine(),l.scrollIntoView()})),e.provide(lt,c),()=>{var t;const r=`${l.id}-${i.value}`,{animated:u,swipeable:d,scrollspy:v,lazyRender:p}=l.props;if(!n.default&&!u)return;const f=v||c.value;if(u||d)return e.createVNode(ct,{id:o,role:"tabpanel",class:ut("panel-wrapper",{inactive:s.value}),tabindex:c.value?0:-1,"aria-hidden":!c.value,"aria-labelledby":r},{default:()=>{var t;return[e.createVNode("div",{class:ut("panel")},[null==(t=n.default)?void 0:t.call(n)])]}});const h=a.value||v||!p?null==(t=n.default)?void 0:t.call(n):null;return pe({id:o}),e.withDirectives(e.createVNode("div",{id:o,role:"tabpanel",class:ut("panel"),tabindex:f?0:-1,"aria-labelledby":r},[h]),[[e.vShow,f]])}}})),pt=ae(at),[ft,ht,mt]=ne("picker"),[gt]=ne("picker-toolbar"),bt={title:String,cancelButtonText:String,confirmButtonText:String};var wt=e.defineComponent({name:gt,props:bt,emits:["confirm","cancel"],setup(t,{emit:n,slots:o}){const a=()=>n("cancel"),l=()=>n("confirm"),i=()=>{const n=t.cancelButtonText||mt("cancel");return e.createVNode("button",{type:"button",class:[ht("cancel"),"van-haptics-feedback"],onClick:a},[o.cancel?o.cancel():n])},r=()=>{const n=t.confirmButtonText||mt("confirm");return e.createVNode("button",{type:"button",class:[ht("confirm"),"van-haptics-feedback"],onClick:l},[o.confirm?o.confirm():n])};return()=>e.createVNode("div",{class:ht("toolbar")},[o.toolbar?o.toolbar():[i(),o.title?o.title():t.title?e.createVNode("div",{class:[ht("title"),"van-ellipsis"]},[t.title]):void 0,r()]])}});const[yt,xt]=ne("picker-group"),Ct=Symbol(yt),Nt=i({tabs:f()},bt);e.defineComponent({name:yt,props:Nt,emits:["confirm","cancel"],setup(t,{emit:n,slots:o}){const{children:a,linkChildren:l}=S(Ct);l();const i=()=>{n("confirm",a.map((e=>e.confirm())))},r=()=>n("cancel");return()=>{var n;const a=null==(n=o.default)?void 0:n.call(o);return e.createVNode("div",{class:xt()},[e.createVNode(wt,e.mergeProps(t,{onConfirm:i,onCancel:r}),null),e.createVNode(pt,{shrink:!0,class:xt("tabs"),animated:!0},{default:()=>[t.tabs.map(((t,n)=>e.createVNode(vt,{title:t,titleClass:xt("tab-title")},{default:()=>[null==a?void 0:a[n]]})))]})])}}});const kt=i({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:h(44),showToolbar:v,swipeDuration:h(1e3),visibleOptionNum:h(6)},Se),Vt=i({},kt,{columns:f(),modelValue:f(),toolbarPosition:m("top"),columnsFieldNames:Object});console.log("%c 🍖 name","color:#42b983",ie);const St=ae(e.defineComponent({name:"BetterVantPicker",props:Vt,emits:["confirm","cancel","change","clickOption","update:modelValue"],setup(n,{emit:o,slots:a}){const l=e.ref(),r=e.ref(n.modelValue.slice(0)),{parent:c}=k(Ct),{children:d,linkChildren:v}=S(Ne);v();const p=e.computed((()=>function(e){return i({text:"text",value:"value",children:"children"},e)}(n.columnsFieldNames))),f=e.computed((()=>W(n.optionHeight))),h=e.computed((()=>function(e,t){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(t.children in n)return"cascade"}return"default"}(n.columns,p.value))),m=e.computed((()=>{const{columns:e}=n;switch(h.value){case"multiple":return e;case"cascade":return function(e,n,o){const a=[];let l={[n.children]:e},i=0;for(;l&&l[n.children];){const e=l[n.children],r=o.value[i];l=t(r)?ve(e,r,n):void 0,!l&&e.length&&(l=ve(e,se(e)[n.value],n)),i++,a.push(e)}return a}(e,p.value,r);default:return[e]}})),g=e.computed((()=>m.value.some((e=>e.length)))),b=e.computed((()=>m.value.map(((e,t)=>ve(e,r.value[t],p.value))))),w=(e,t)=>{if(r.value[e]!==t){const n=r.value.slice(0);n[e]=t,r.value=n}},y=()=>({selectedValues:r.value.slice(0),selectedOptions:b.value}),x=()=>{d.forEach((e=>e.stopMomentum()));const e=y();return o("confirm",e),e},C=()=>o("cancel",y()),N=()=>m.value.map(((t,l)=>e.createVNode(ke,{value:r.value[l],fields:p.value,options:t,readonly:n.readonly,allowHtml:n.allowHtml,optionHeight:f.value,swipeDuration:n.swipeDuration,visibleOptionNum:n.visibleOptionNum,onChange:e=>((e,t)=>{w(t,e),"cascade"===h.value&&r.value.forEach(((e,t)=>{const n=m.value[t];de(n,e,p.value)||w(t,n.length?n[0][p.value.value]:void 0)})),o("change",i({columnIndex:t},y()))})(e,l),onClickOption:e=>((e,t)=>o("clickOption",i({columnIndex:t,currentOption:e},y())))(e,l)},{option:a.option}))),V=t=>{if(g.value){const n={height:`${f.value}px`},o={backgroundSize:`100% ${(t-f.value)/2}px`};return[e.createVNode("div",{class:re("mask"),style:o},null),e.createVNode("div",{class:["van-hairline-unset--top-bottom",re("frame")],style:n},null)]}},T=()=>{const t=f.value*+n.visibleOptionNum,o={height:`${t}px`};return e.createVNode("div",{ref:l,class:re("columns"),style:o},[N(),V(t)])},B=()=>{if(n.showToolbar&&!c)return e.createVNode(Be,e.mergeProps(s(n,$e),{onConfirm:x,onCancel:C}),s(a,Te))};let O;e.watch(m,(e=>{e.forEach(((e,t)=>{e.length&&!de(e,r.value[t],p.value)&&w(t,se(e)[p.value.value])}))}),{immediate:!0}),e.watch((()=>n.modelValue),(e=>{u(e,r.value)||u(e,O)||(r.value=e.slice(0))}),{deep:!0}),e.watch(r,(e=>{u(e,n.modelValue)||(O=e.slice(0),o("update:modelValue",O))}),{immediate:!0}),$("touchmove",D,{target:l});return pe({confirm:x,getSelectedOptions:()=>b.value}),()=>{var t,o;return e.createVNode("div",{class:re()},["top"===n.toolbarPosition?B():null,n.loading?e.createVNode(we,{class:re("loading")},null):null,null==(t=a["columns-top"])?void 0:t.call(a),T(),null==(o=a["columns-bottom"])?void 0:o.call(a),"bottom"===n.toolbarPosition?B():null])}}})),Tt={install(e){e.component(St.name,St)}};exports.BetterPicker=St,exports.default=Tt;
