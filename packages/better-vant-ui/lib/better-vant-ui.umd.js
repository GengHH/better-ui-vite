!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).BetterVantUI={},e.Vue)}(this,(function(e,t){"use strict";const n=e=>null!=e,o=e=>"function"==typeof e,l=e=>null!==e&&"object"==typeof e,i=e=>"number"==typeof e||/^\d+(\.\d+)?$/.test(e);function a(){}const r=Object.assign,c="undefined"!=typeof window;function s(e,t){const n=t.split(".");let o=e;return n.forEach((e=>{var t;o=l(o)&&null!=(t=o[e])?t:""})),o}function u(e,t,n){return t.reduce(((t,o)=>(n&&void 0===e[o]||(t[o]=e[o]),t)),{})}const d=(e,t)=>JSON.stringify(e)===JSON.stringify(t),v=[Number,String],p={type:Boolean,default:!0},f=e=>({type:e,required:!0}),h=()=>({type:Array,default:()=>[]}),m=e=>({type:v,default:e}),g=e=>({type:String,default:e});var b="undefined"!=typeof window;function w(e){return b?requestAnimationFrame(e):-1}function y(e){w((()=>w(e)))}var x,C,N=(e,t)=>({top:0,left:0,right:e,bottom:t,width:e,height:t}),V=e=>{const n=t.unref(e);if(n===window){const e=n.innerWidth,t=n.innerHeight;return N(e,t)}return(null==n?void 0:n.getBoundingClientRect)?n.getBoundingClientRect():N(0,0)};function k(e){const n=t.inject(e,null);if(n){const e=t.getCurrentInstance(),{link:o,unlink:l,internalChildren:i}=n;o(e),t.onUnmounted((()=>l(e)));return{parent:n,index:t.computed((()=>i.indexOf(e)))}}return{parent:null,index:t.ref(-1)}}function S(e,n,o){const l=function(e){const n=[],o=e=>{Array.isArray(e)&&e.forEach((e=>{var l;t.isVNode(e)&&(n.push(e),(null==(l=e.component)?void 0:l.subTree)&&(n.push(e.component.subTree),o(e.component.subTree.children)),e.children&&o(e.children))}))};return o(e),n}(e.subTree.children);o.sort(((e,t)=>l.indexOf(e.vnode)-l.indexOf(t.vnode)));const i=o.map((e=>e.proxy));n.sort(((e,t)=>i.indexOf(e)-i.indexOf(t)))}function T(e){const n=t.reactive([]),o=t.reactive([]),l=t.getCurrentInstance();return{children:n,linkChildren:i=>{t.provide(e,Object.assign({link:e=>{e.proxy&&(o.push(e),n.push(e.proxy),S(l,n,o))},unlink:e=>{const t=o.indexOf(e);n.splice(t,1),o.splice(t,1)},children:n,internalChildren:o},i))}}}function $(e){let n;t.onMounted((()=>{e(),t.nextTick((()=>{n=!0}))})),t.onActivated((()=>{n&&e()}))}function B(e,n,o={}){if(!b)return;const{target:l=window,passive:i=!1,capture:a=!1}=o;let r;const c=o=>{const l=t.unref(o);l&&!r&&(l.addEventListener(e,n,{capture:a,passive:i}),r=!0)},s=o=>{const l=t.unref(o);l&&r&&(l.removeEventListener(e,n,a),r=!1)};t.onUnmounted((()=>s(l))),t.onDeactivated((()=>s(l))),$((()=>c(l))),t.isRef(l)&&t.watch(l,((e,t)=>{s(t),c(e)}))}var O,I=/scroll|auto|overlay/i,z=b?window:void 0;function M(e){return"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType}function A(e,n=z){const o=t.ref();return t.onMounted((()=>{e.value&&(o.value=function(e,t=z){let n=e;for(;n&&n!==t&&M(n);){const{overflowY:e}=window.getComputedStyle(n);if(I.test(e))return n;n=n.parentNode}return t}(e.value,n))})),o}function E(e){const t="scrollTop"in e?e.scrollTop:e.pageYOffset;return Math.max(t,0)}function H(e,t){"scrollTop"in e?e.scrollTop=t:e.scrollTo(e.scrollX,t)}function D(e,t){if(e===window)return 0;const n=t?E(t):window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;return V(e).top+n}c&&/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase());function P(e,t){("boolean"!=typeof e.cancelable||e.cancelable)&&e.preventDefault(),t&&(e=>{e.stopPropagation()})(e)}function R(e){const n=t.unref(e);if(!n)return!1;const o=window.getComputedStyle(n),l="none"===o.display,i=null===n.offsetParent&&"fixed"!==o.position;return l||i}const{width:j,height:L}=function(){if(!x&&(x=t.ref(0),C=t.ref(0),b)){const e=()=>{x.value=window.innerWidth,C.value=window.innerHeight};e(),window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",e,{passive:!0})}return{width:x,height:C}}();function Y(e){if(n(e))return i(e)?`${e}px`:String(e)}let X;function W(e){return+(e=e.replace(/rem/g,""))*function(){if(!X){const e=document.documentElement,t=e.style.fontSize||window.getComputedStyle(e).fontSize;X=parseFloat(t)}return X}()}function F(e){if("number"==typeof e)return e;if(c){if(e.includes("rem"))return W(e);if(e.includes("vw"))return function(e){return+(e=e.replace(/vw/g,""))*j.value/100}(e);if(e.includes("vh"))return function(e){return+(e=e.replace(/vh/g,""))*L.value/100}(e)}return parseFloat(e)}const U=/-(\w)/g,Z=e=>e.replace(U,((e,t)=>t.toUpperCase())),_=(e,t,n)=>Math.min(Math.max(e,t),n),{hasOwnProperty:q}=Object.prototype;function J(e,t){return Object.keys(t).forEach((o=>{!function(e,t,o){const i=t[o];n(i)&&(q.call(e,o)&&l(i)?e[o]=J(Object(e[o]),i):e[o]=i)}(e,t,o)})),e}const G=t.ref("zh-CN"),K=t.reactive({"zh-CN":{name:"姓名",tel:"电话",save:"保存",confirm:"确认",cancel:"取消",delete:"删除",loading:"加载中...",noCoupon:"暂无优惠券",nameEmpty:"请填写姓名",addContact:"添加联系人",telInvalid:"请填写正确的电话",vanCalendar:{end:"结束",start:"开始",title:"日期选择",weekdays:["日","一","二","三","四","五","六"],monthTitle:(e,t)=>`${e}年${t}月`,rangePrompt:e=>`最多选择 ${e} 天`},vanCascader:{select:"请选择"},vanPagination:{prev:"上一页",next:"下一页"},vanPullRefresh:{pulling:"下拉即可刷新...",loosing:"释放即可刷新..."},vanSubmitBar:{label:"合计:"},vanCoupon:{unlimited:"无门槛",discount:e=>`${e}折`,condition:e=>`满${e}元可用`},vanCouponCell:{title:"优惠券",count:e=>`${e}张可用`},vanCouponList:{exchange:"兑换",close:"不使用",enable:"可用",disabled:"不可用",placeholder:"输入优惠码"},vanAddressEdit:{area:"地区",areaEmpty:"请选择地区",addressEmpty:"请填写详细地址",addressDetail:"详细地址",defaultAddress:"设为默认收货地址"},vanAddressList:{add:"新增地址"}}});var Q={messages:()=>K[G.value],use(e,t){G.value=e,this.add({[e]:t})},add(e={}){J(K,e)}};function ee(e){const t=Z(e)+".";return(e,...n)=>{const l=Q.messages(),i=s(l,t+e)||s(l,e);return o(i)?i(...n):i}}function te(e,t){return t?"string"==typeof t?` ${e}--${t}`:Array.isArray(t)?t.reduce(((t,n)=>t+te(e,n)),""):Object.keys(t).reduce(((n,o)=>n+(t[o]?te(e,o):"")),""):""}function ne(e){return(t,n)=>(t&&"string"!=typeof t&&(n=t,t=""),`${t=t?`${e}__${t}`:e}${te(t,n)}`)}function oe(e){const t=`van-${e}`;return[t,ne(t),ee(t)]}const le="van-hairline",ie=`${le}--top-bottom`,ae=`${le}-unset--top-bottom`,re="van-haptics-feedback";function ce(e,{args:t=[],done:n,canceled:i}){if(e){const c=e.apply(null,t);l(r=c)&&o(r.then)&&o(r.catch)?c.then((e=>{e?n():i&&i()})).catch(a):c?n():i&&i()}else n();var r}function se(e){return e.install=t=>{const{name:n}=e;n&&(t.component(n,e),t.component(Z(`-${n}`),e))},e}function ue(e){const t=`van-${e}`;return console.log("%c 🍔 prefixedName","color:#e41a6a",t),[t,ne(t),ee(t)]}const[de,ve,pe]=ue("picker"),fe=e=>e.find((e=>!e.disabled))||e[0];function he(e,t){for(let n=t=_(t,0,e.length);n<e.length;n++)if(!e[n].disabled)return n;for(let n=t-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const me=(e,t,n)=>void 0!==t&&!!e.find((e=>e[n.value]===t));function ge(e,t,n){const o=e.findIndex((e=>e[n.value]===t));return e[he(e,o)]}function be(e){const n=t.getCurrentInstance();n&&r(n.proxy,e)}const[we,ye]=oe("loading"),xe=Array(12).fill(null).map(((e,n)=>t.createVNode("i",{class:ye("line",String(n+1))},null))),Ce=t.createVNode("svg",{class:ye("circular"),viewBox:"25 25 50 50"},[t.createVNode("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),Ne={size:v,type:g("circular"),color:String,vertical:Boolean,textSize:v,textColor:String};const Ve=se(t.defineComponent({name:we,props:Ne,setup(e,{slots:o}){const l=t.computed((()=>r({color:e.color},function(e){if(n(e)){if(Array.isArray(e))return{width:Y(e[0]),height:Y(e[1])};const t=Y(e);return{width:t,height:t}}}(e.size)))),i=()=>{var n;if(o.default)return t.createVNode("span",{class:ye("text"),style:{fontSize:Y(e.textSize),color:null!=(n=e.textColor)?n:e.color}},[o.default()])};return()=>{const{type:n,vertical:o}=e;return t.createVNode("div",{class:ye([n,{vertical:o}]),"aria-live":"polite","aria-busy":!0},[t.createVNode("span",{class:ye("spinner",n),style:l.value},["spinner"===n?xe:Ce]),i()])}}}));function ke(){const e=t.ref(0),n=t.ref(0),o=t.ref(0),l=t.ref(0),i=t.ref(0),a=t.ref(0),r=t.ref(""),c=()=>{o.value=0,l.value=0,i.value=0,a.value=0,r.value=""};return{move:t=>{const c=t.touches[0];o.value=(c.clientX<0?0:c.clientX)-e.value,l.value=c.clientY-n.value,i.value=Math.abs(o.value),a.value=Math.abs(l.value);var s,u;(!r.value||i.value<10&&a.value<10)&&(r.value=(s=i.value,u=a.value,s>u?"horizontal":u>s?"vertical":""))},start:t=>{c(),e.value=t.touches[0].clientX,n.value=t.touches[0].clientY},reset:c,startX:e,startY:n,deltaX:o,deltaY:l,offsetX:i,offsetY:a,direction:r,isVertical:()=>"vertical"===r.value,isHorizontal:()=>"horizontal"===r.value}}const[Se,Te]=ue("picker-column"),$e=Symbol(Se),Be=t.defineComponent({name:Se,props:{value:v,fields:f(Object),options:h(),readonly:Boolean,allowHtml:Boolean,optionHeight:f(Number),swipeDuration:f(v),visibleOptionNum:f(v)},emits:["change","clickOption"],setup(e,{emit:n,slots:o}){let l,i,a,r,c;const s=t.ref(),u=t.ref(),d=t.ref(0),v=t.ref(0),p=ke(),f=()=>e.options.length,h=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,m=t=>{const o=he(e.options,t),i=-o*e.optionHeight,a=()=>{const t=e.options[o][e.fields.value];t!==e.value&&n("change",t)};l&&i!==d.value?c=a:a(),d.value=i},g=t=>_(Math.round(-t/e.optionHeight),0,f()-1),b=()=>{l=!1,v.value=0,c&&(c(),c=null)},w=t=>{if(!e.readonly){if(p.start(t),l){const e=function(e){const{transform:t}=window.getComputedStyle(e),n=t.slice(7,t.length-1).split(", ")[5];return Number(n)}(u.value);d.value=Math.min(0,e-h())}v.value=0,i=d.value,a=Date.now(),r=i,c=null}},y=()=>{if(e.readonly)return;const t=d.value-r,n=Date.now()-a;if(n<300&&Math.abs(t)>15)return void((t,n)=>{const o=Math.abs(t/n);t=d.value+o/.003*(t<0?-1:1);const l=g(t);v.value=+e.swipeDuration,m(l)})(t,n);const o=g(d.value);v.value=200,m(o),setTimeout((()=>{l=!1}),0)},x=()=>{const i={height:`${e.optionHeight}px`};return e.options.map(((a,r)=>{const s=a[e.fields.text],{disabled:u}=a,d=a[e.fields.value],p={role:"button",style:i,tabindex:u?-1:0,class:[Te("item",{disabled:u,selected:d===e.value}),a.className],onClick:()=>(t=>{l||e.readonly||(c=null,v.value=200,m(t),n("clickOption",e.options[t]))})(r)},f={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:s};return t.createVNode("li",p,[o.option?o.option(a):t.createVNode("div",f,null)])}))};return k($e),be({stopMomentum:b}),t.watchEffect((()=>{const t=e.options.findIndex((t=>t[e.fields.value]===e.value)),n=-he(e.options,t)*e.optionHeight;d.value=n})),B("touchmove",(t=>{if(e.readonly)return;p.move(t),p.isVertical()&&(l=!0,P(t,!0)),d.value=_(i+p.deltaY.value,-f()*e.optionHeight,e.optionHeight);const n=Date.now();n-a>300&&(a=n,r=d.value)}),{target:s}),()=>t.createVNode("div",{ref:s,class:Te(),onTouchstartPassive:w,onTouchend:y,onTouchcancel:y},[t.createVNode("ul",{ref:u,style:{transform:`translate3d(0, ${d.value+h()}px, 0)`,transitionDuration:`${v.value}ms`,transitionProperty:v.value?"all":"none"},class:Te("wrapper"),onTransitionend:b},[x()])])}}),[Oe]=ue("picker-toolbar"),Ie={title:String,cancelButtonText:String,confirmButtonText:String},ze=["cancel","confirm","title","toolbar"],Me=Object.keys(Ie),Ae=t.defineComponent({name:Oe,props:Ie,emits:["confirm","cancel"],setup(e,{emit:n,slots:o}){const l=()=>n("cancel"),i=()=>n("confirm"),a=()=>{const n=e.cancelButtonText||pe("cancel");return t.createVNode("button",{type:"button",class:[ve("cancel"),re],onClick:l},[o.cancel?o.cancel():n])},r=()=>{const n=e.confirmButtonText||pe("confirm");return t.createVNode("button",{type:"button",class:[ve("confirm"),re],onClick:i},[o.confirm?o.confirm():n])};return()=>t.createVNode("div",{class:ve("toolbar")},[o.toolbar?o.toolbar():[a(),o.title?o.title():e.title?t.createVNode("div",{class:[ve("title"),"van-ellipsis"]},[e.title]):void 0,r()]])}});let Ee=0;function He(){const e=t.getCurrentInstance(),{name:n="unknown"}=(null==e?void 0:e.type)||{};return"test"===process.env.NODE_ENV?n:`${n}-${++Ee}`}const De={to:[String,Object],url:String,replace:Boolean};const Pe=Symbol();function Re(e){const n=t.inject(Pe,null);n&&t.watch(n,(t=>{t&&e()}))}const[je,Le]=oe("sticky"),Ye={zIndex:v,position:g("top"),container:Object,offsetTop:m(0),offsetBottom:m(0)};const Xe=se(t.defineComponent({name:je,props:Ye,emits:["scroll","change"],setup(e,{emit:n,slots:o}){const l=t.ref(),i=A(l),a=t.reactive({fixed:!1,width:0,height:0,transform:0}),s=t.computed((()=>F("top"===e.position?e.offsetTop:e.offsetBottom))),u=t.computed((()=>{const{fixed:e,height:t,width:n}=a;if(e)return{width:`${n}px`,height:`${t}px`}})),d=t.computed((()=>{if(!a.fixed)return;const t=r(function(e){const t={};return void 0!==e&&(t.zIndex=+e),t}(e.zIndex),{width:`${a.width}px`,height:`${a.height}px`,[e.position]:`${s.value}px`});return a.transform&&(t.transform=`translate3d(0, ${a.transform}px, 0)`),t})),v=()=>{if(!l.value||R(l))return;const{container:t,position:o}=e,i=V(l),r=E(window);if(a.width=i.width,a.height=i.height,"top"===o)if(t){const e=V(t),n=e.bottom-s.value-a.height;a.fixed=s.value>i.top&&e.bottom>0,a.transform=n<0?n:0}else a.fixed=s.value>i.top;else{const{clientHeight:e}=document.documentElement;if(t){const n=V(t),o=e-n.top-s.value-a.height;a.fixed=e-s.value<i.bottom&&e>n.top,a.transform=o<0?-o:0}else a.fixed=e-s.value<i.bottom}(e=>{n("scroll",{scrollTop:e,isFixed:a.fixed})})(r)};return t.watch((()=>a.fixed),(e=>n("change",e))),B("scroll",v,{target:i,passive:!0}),function(e,n){if(!c||!window.IntersectionObserver)return;const o=new IntersectionObserver((e=>{n(e[0].intersectionRatio>0)}),{root:document.body}),l=()=>{e.value&&o.unobserve(e.value)};t.onDeactivated(l),t.onBeforeUnmount(l),$((()=>{e.value&&o.observe(e.value)}))}(l,v),()=>{var e;return t.createVNode("div",{ref:l,style:u.value},[t.createVNode("div",{class:Le({fixed:a.fixed}),style:d.value},[null==(e=o.default)?void 0:e.call(o)])])}}})),[We,Fe]=oe("badge"),Ue={dot:Boolean,max:v,tag:g("div"),color:String,offset:Array,content:v,showZero:p,position:g("top-right")};const Ze=se(t.defineComponent({name:We,props:Ue,setup(e,{slots:o}){const l=()=>{if(o.content)return!0;const{content:t,showZero:l}=e;return n(t)&&""!==t&&(l||0!==t&&"0"!==t)},a=()=>{const{dot:t,max:a,content:r}=e;if(!t&&l())return o.content?o.content():n(a)&&i(r)&&+r>a?`${a}+`:r},r=t.computed((()=>{const t={background:e.color};if(e.offset){const[n,l]=e.offset;o.default?(t.top=Y(l),t.right="number"==typeof n?Y(-n):n.startsWith("-")?n.replace("-",""):`-${n}`):(t.marginTop=Y(l),t.marginLeft=Y(n))}return t})),c=()=>{if(l()||e.dot)return t.createVNode("div",{class:Fe([e.position,{dot:e.dot,fixed:!!o.default}]),style:r.value},[a()])};return()=>{if(o.default){const{tag:n}=e;return t.createVNode(n,{class:Fe("wrapper")},{default:()=>[o.default(),c()]})}return c()}}})),[_e,qe]=oe("tab");var Je=t.defineComponent({name:_e,props:{id:String,dot:Boolean,type:String,color:String,title:String,badge:v,shrink:Boolean,isActive:Boolean,disabled:Boolean,controls:String,scrollable:Boolean,activeColor:String,inactiveColor:String,showZeroBadge:p},setup(e,{slots:o}){const l=t.computed((()=>{const t={},{type:n,color:o,disabled:l,isActive:i,activeColor:a,inactiveColor:r}=e;o&&"card"===n&&(t.borderColor=o,l||(i?t.backgroundColor=o:t.color=o));const c=i?a:r;return c&&(t.color=c),t})),i=()=>{const l=t.createVNode("span",{class:qe("text",{ellipsis:!e.scrollable})},[o.title?o.title():e.title]);return e.dot||n(e.badge)&&""!==e.badge?t.createVNode(Ze,{dot:e.dot,content:e.badge,showZero:e.showZeroBadge},{default:()=>[l]}):l};return()=>t.createVNode("div",{id:e.id,role:"tab",class:[qe([e.type,{grow:e.scrollable&&!e.shrink,shrink:e.shrink,active:e.isActive,disabled:e.disabled}])],style:l.value,tabindex:e.disabled?void 0:e.isActive?0:-1,"aria-selected":e.isActive,"aria-disabled":e.disabled||void 0,"aria-controls":e.controls},[i()])}});const[Ge,Ke]=oe("swipe"),Qe={loop:p,width:v,height:v,vertical:Boolean,autoplay:m(0),duration:m(500),touchable:p,lazyRender:Boolean,initialSwipe:m(0),indicatorColor:String,showIndicators:p,stopPropagation:p},et=Symbol(Ge);const tt=se(t.defineComponent({name:Ge,props:Qe,emits:["change"],setup(e,{emit:n,slots:o}){const l=t.ref(),i=t.ref(),a=t.reactive({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),r=ke(),{children:c,linkChildren:s}=T(et),u=t.computed((()=>c.length)),d=t.computed((()=>a[e.vertical?"height":"width"])),v=t.computed((()=>e.vertical?r.deltaY.value:r.deltaX.value)),p=t.computed((()=>{if(a.rect){return(e.vertical?a.rect.height:a.rect.width)-d.value*u.value}return 0})),f=t.computed((()=>Math.ceil(Math.abs(p.value)/d.value))),h=t.computed((()=>u.value*d.value)),m=t.computed((()=>(a.active+u.value)%u.value)),g=t.computed((()=>{const t=e.vertical?"vertical":"horizontal";return r.direction.value===t})),w=t.computed((()=>{const t={transitionDuration:`${a.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${a.offset}px)`};if(d.value){const n=e.vertical?"height":"width",o=e.vertical?"width":"height";t[n]=`${h.value}px`,t[o]=e[o]?`${e[o]}px`:""}return t})),x=(t,n=0)=>{let o=t*d.value;e.loop||(o=Math.min(o,-p.value));let l=n-o;return e.loop||(l=_(l,p.value,0)),l},C=({pace:t=0,offset:o=0,emitChange:l})=>{if(u.value<=1)return;const{active:i}=a,r=(t=>{const{active:n}=a;return t?e.loop?_(n+t,-1,u.value):_(n+t,0,f.value):n})(t),s=x(r,o);if(e.loop){if(c[0]&&s!==p.value){const e=s<p.value;c[0].setOffset(e?h.value:0)}if(c[u.value-1]&&0!==s){const e=s>0;c[u.value-1].setOffset(e?-h.value:0)}}a.active=r,a.offset=s,l&&r!==i&&n("change",m.value)},N=()=>{a.swiping=!0,a.active<=-1?C({pace:u.value}):a.active>=u.value&&C({pace:-u.value})},V=()=>{N(),r.reset(),y((()=>{a.swiping=!1,C({pace:1,emitChange:!0})}))};let k;const S=()=>clearTimeout(k),$=()=>{S(),e.autoplay>0&&u.value>1&&(k=setTimeout((()=>{V(),$()}),+e.autoplay))},I=(n=+e.initialSwipe)=>{if(!l.value)return;const o=()=>{var t,o;if(!R(l)){const n={width:l.value.offsetWidth,height:l.value.offsetHeight};a.rect=n,a.width=+(null!=(t=e.width)?t:n.width),a.height=+(null!=(o=e.height)?o:n.height)}u.value&&(n=Math.min(u.value-1,n)),a.active=n,a.swiping=!0,a.offset=x(n),c.forEach((e=>{e.setOffset(0)})),$()};R(l)?t.nextTick().then(o):o()},z=()=>I(a.active);let M;const A=t=>{e.touchable&&(r.start(t),M=Date.now(),S(),N())},E=()=>{if(!e.touchable||!a.swiping)return;const t=Date.now()-M,n=v.value/t;if((Math.abs(n)>.25||Math.abs(v.value)>d.value/2)&&g.value){const t=e.vertical?r.offsetY.value:r.offsetX.value;let n=0;n=e.loop?t>0?v.value>0?-1:1:0:-Math[v.value>0?"ceil":"floor"](v.value/d.value),C({pace:n,emitChange:!0})}else v.value&&C({pace:0});a.swiping=!1,$()},H=(n,o)=>{const l=o===m.value,i=l?{backgroundColor:e.indicatorColor}:void 0;return t.createVNode("i",{style:i,class:Ke("indicator",{active:l})},null)};return be({prev:()=>{N(),r.reset(),y((()=>{a.swiping=!1,C({pace:-1,emitChange:!0})}))},next:V,state:a,resize:z,swipeTo:(t,n={})=>{N(),r.reset(),y((()=>{let o;o=e.loop&&t===u.value?0===a.active?0:t:t%u.value,n.immediate?y((()=>{a.swiping=!1})):a.swiping=!1,C({pace:o-a.active,emitChange:!0})}))}}),s({size:d,props:e,count:u,activeIndicator:m}),t.watch((()=>e.initialSwipe),(e=>I(+e))),t.watch(u,(()=>I(a.active))),t.watch((()=>e.autoplay),$),t.watch([j,L],z),t.watch(function(){if(!O&&(O=t.ref("visible"),b)){const e=()=>{O.value=document.hidden?"hidden":"visible"};e(),window.addEventListener("visibilitychange",e)}return O}(),(e=>{"visible"===e?$():S()})),t.onMounted(I),t.onActivated((()=>I(a.active))),Re((()=>I(a.active))),t.onDeactivated(S),t.onBeforeUnmount(S),B("touchmove",(t=>{if(e.touchable&&a.swiping&&(r.move(t),g.value)){!e.loop&&(0===a.active&&v.value>0||a.active===u.value-1&&v.value<0)||(P(t,e.stopPropagation),C({offset:v.value}))}}),{target:i}),()=>{var n;return t.createVNode("div",{ref:l,class:Ke()},[t.createVNode("div",{ref:i,style:w.value,class:Ke("track",{vertical:e.vertical}),onTouchstartPassive:A,onTouchend:E,onTouchcancel:E},[null==(n=o.default)?void 0:n.call(o)]),o.indicator?o.indicator({active:m.value,total:u.value}):e.showIndicators&&u.value>1?t.createVNode("div",{class:Ke("indicators",{vertical:e.vertical})},[Array(u.value).fill("").map(H)]):void 0])}}})),[nt,ot]=oe("tabs");var lt=t.defineComponent({name:nt,props:{count:f(Number),inited:Boolean,animated:Boolean,duration:f(v),swipeable:Boolean,lazyRender:Boolean,currentIndex:f(Number)},emits:["change"],setup(e,{emit:n,slots:o}){const l=t.ref(),i=e=>n("change",e),a=()=>{var n;const a=null==(n=o.default)?void 0:n.call(o);return e.animated||e.swipeable?t.createVNode(tt,{ref:l,loop:!1,class:ot("track"),duration:1e3*+e.duration,touchable:e.swipeable,lazyRender:e.lazyRender,showIndicators:!1,onChange:i},{default:()=>[a]}):a},r=t=>{const n=l.value;n&&n.state.active!==t&&n.swipeTo(t,{immediate:!e.inited})};return t.watch((()=>e.currentIndex),r),t.onMounted((()=>{r(e.currentIndex)})),be({swipeRef:l}),()=>t.createVNode("div",{class:ot("content",{animated:e.animated||e.swipeable})},[a()])}});const[it,at]=oe("tabs"),rt={type:g("line"),color:String,border:Boolean,sticky:Boolean,shrink:Boolean,active:m(0),duration:m(.3),animated:Boolean,ellipsis:p,swipeable:Boolean,scrollspy:Boolean,offsetTop:m(0),background:String,lazyRender:p,lineWidth:v,lineHeight:v,beforeChange:Function,swipeThreshold:m(5),titleActiveColor:String,titleInactiveColor:String},ct=Symbol(it);var st=t.defineComponent({name:it,props:rt,emits:["change","scroll","rendered","clickTab","update:active"],setup(e,{emit:o,slots:l}){let i,a,r;const c=t.ref(),s=t.ref(),d=t.ref(),v=t.ref(),p=He(),f=A(c),[h,m]=function(){const e=t.ref([]),n=[];return t.onBeforeUpdate((()=>{e.value=[]})),[e,t=>(n[t]||(n[t]=n=>{e.value[t]=n}),n[t])]}(),{children:g,linkChildren:b}=T(ct),y=t.reactive({inited:!1,position:"",lineStyle:{},currentIndex:-1}),x=t.computed((()=>g.length>e.swipeThreshold||!e.ellipsis||e.shrink)),C=t.computed((()=>({borderColor:e.color,background:e.background}))),N=(e,t)=>{var n;return null!=(n=e.name)?n:t},k=t.computed((()=>{const e=g[y.currentIndex];if(e)return N(e,y.currentIndex)})),S=t.computed((()=>F(e.offsetTop))),O=t.computed((()=>e.sticky?S.value+i:0)),I=t=>{const n=s.value,o=h.value;if(!(x.value&&n&&o&&o[y.currentIndex]))return;const l=o[y.currentIndex].$el;!function(e,t,n){let o=0;const l=e.scrollLeft,i=0===n?1:Math.round(1e3*n/16);!function n(){e.scrollLeft+=(t-l)/i,++o<i&&w(n)}()}(n,l.offsetLeft-(n.offsetWidth-l.offsetWidth)/2,t?0:+e.duration)},z=()=>{const o=y.inited;t.nextTick((()=>{const t=h.value;if(!t||!t[y.currentIndex]||"line"!==e.type||R(c.value))return;const l=t[y.currentIndex].$el,{lineWidth:i,lineHeight:a}=e,r=l.offsetLeft+l.offsetWidth/2,s={width:Y(i),backgroundColor:e.color,transform:`translateX(${r}px) translateX(-50%)`};if(o&&(s.transitionDuration=`${e.duration}s`),n(a)){const e=Y(a);s.height=e,s.borderRadius=e}y.lineStyle=s}))},M=(t,l)=>{const i=(e=>{const t=e<y.currentIndex?-1:1;for(;e>=0&&e<g.length;){if(!g[e].disabled)return e;e+=t}})(t);if(!n(i))return;const a=g[i],s=N(a,i),u=null!==y.currentIndex;var d;y.currentIndex=i,s!==e.active&&(o("update:active",s),u&&o("change",s,a.title)),l||I(),z(),r&&!e.scrollspy&&(d=Math.ceil(D(c.value)-S.value),H(window,d),H(document.body,d))},P=(e,t)=>{const n=g.find(((t,n)=>N(t,n)===e)),o=n?g.indexOf(n):0;M(o,t)},L=(t=!1)=>{if(e.scrollspy){const n=g[y.currentIndex].$el;if(n&&f.value){const o=D(n,f.value)-O.value;a=!0,function(e,t,n,o){let l=E(e);const i=l<t,a=0===n?1:Math.round(1e3*n/16),r=(t-l)/a;!function n(){l+=r,(i&&l>t||!i&&l<t)&&(l=t),H(e,l),i&&l<t||!i&&l>t?w(n):o&&w(o)}()}(f.value,o,t?0:+e.duration,(()=>{a=!1}))}}},X=(t,n,l)=>{const{title:i,disabled:a}=g[n],r=N(g[n],n);a||(ce(e.beforeChange,{args:[r],done:()=>{M(n),L()}}),function({to:e,url:t,replace:n,$router:o}){e&&o?o[n?"replace":"push"](e):t&&(n?location.replace(t):location.href=t)}(t)),o("clickTab",{name:r,title:i,event:l,disabled:a})},W=e=>{r=e.isFixed,o("scroll",e)},U=()=>{if("line"===e.type&&g.length)return t.createVNode("div",{class:at("line"),style:y.lineStyle},null)},Z=()=>{var n,o;const{type:i,border:a}=e;return t.createVNode("div",{ref:d,class:[at("wrap"),{[ie]:"line"===i&&a}]},[t.createVNode("div",{ref:s,role:"tablist",class:at("nav",[i,{shrink:e.shrink,complete:x.value}]),style:C.value,"aria-orientation":"horizontal"},[null==(n=l["nav-left"])?void 0:n.call(l),g.map(((n,o)=>t.createVNode(Je,t.mergeProps({key:n.id,id:`${p}-${o}`,ref:m(o),type:e.type,color:e.color,style:n.titleStyle,class:n.titleClass,shrink:e.shrink,isActive:o===y.currentIndex,controls:n.id,scrollable:x.value,activeColor:e.titleActiveColor,inactiveColor:e.titleInactiveColor,onClick:e=>X(n,o,e)},u(n,["dot","badge","title","disabled","showZeroBadge"])),{title:n.$slots.title}))),U(),null==(o=l["nav-right"])?void 0:o.call(l)])])};t.watch([()=>e.color,j],z),t.watch((()=>e.active),(e=>{e!==k.value&&P(e)})),t.watch((()=>g.length),(()=>{y.inited&&(P(e.active),z(),t.nextTick((()=>{I(!0)})))}));return be({resize:()=>{z(),t.nextTick((()=>{var e,t;return null==(t=null==(e=v.value)?void 0:e.swipeRef.value)?void 0:t.resize()}))},scrollTo:e=>{t.nextTick((()=>{P(e),L(!0)}))}}),t.onActivated(z),Re(z),$((()=>{P(e.active,!0),t.nextTick((()=>{y.inited=!0,d.value&&(i=V(d.value).height),I(!0)}))})),B("scroll",(()=>{if(e.scrollspy&&!a){const e=(()=>{for(let e=0;e<g.length;e++){const{top:t}=V(g[e].$el);if(t>O.value)return 0===e?0:e-1}return g.length-1})();M(e)}}),{target:f,passive:!0}),b({id:p,props:e,setLine:z,onRendered:(e,t)=>o("rendered",e,t),currentName:k,scrollIntoView:I}),()=>{var n;return t.createVNode("div",{ref:c,class:at([e.type])},[e.sticky?t.createVNode(Xe,{container:c.value,offsetTop:S.value,onScroll:W},{default:()=>{var e;return[Z(),null==(e=l["nav-bottom"])?void 0:e.call(l)]}}):[Z(),null==(n=l["nav-bottom"])?void 0:n.call(l)],t.createVNode(lt,{ref:v,count:g.length,inited:y.inited,animated:e.animated,duration:e.duration,swipeable:e.swipeable,lazyRender:e.lazyRender,currentIndex:y.currentIndex,onChange:M},{default:()=>{var e;return[null==(e=l.default)?void 0:e.call(l)]}})])}}});const ut=Symbol(),[dt,vt]=oe("swipe-item");const pt=se(t.defineComponent({name:dt,setup(e,{slots:n}){let o;const l=t.reactive({offset:0,inited:!1,mounted:!1}),{parent:i,index:a}=k(et);if(!i)return void("production"!==process.env.NODE_ENV&&console.error("[Vant] <SwipeItem> must be a child component of <Swipe>."));const r=t.computed((()=>{const e={},{vertical:t}=i.props;return i.size.value&&(e[t?"height":"width"]=`${i.size.value}px`),l.offset&&(e.transform=`translate${t?"Y":"X"}(${l.offset}px)`),e})),c=t.computed((()=>{const{loop:e,lazyRender:t}=i.props;if(!t||o)return!0;if(!l.mounted)return!1;const n=i.activeIndicator.value,r=i.count.value-1,c=0===n&&e?r:n-1,s=n===r&&e?0:n+1;return o=a.value===n||a.value===c||a.value===s,o}));return t.onMounted((()=>{t.nextTick((()=>{l.mounted=!0}))})),be({setOffset:e=>{l.offset=e}}),()=>{var e;return t.createVNode("div",{class:vt(),style:r.value},[c.value?null==(e=n.default)?void 0:e.call(n):null])}}})),[ft,ht]=oe("tab"),mt=r({},De,{dot:Boolean,name:v,badge:v,title:String,disabled:Boolean,titleClass:null,titleStyle:[String,Object],showZeroBadge:p});const gt=se(t.defineComponent({name:ft,props:mt,setup(e,{slots:n}){const o=He(),l=t.ref(!1),{parent:i,index:a}=k(ct);if(!i)return void("production"!==process.env.NODE_ENV&&console.error("[Vant] <Tab> must be a child component of <Tabs>."));const r=()=>{var t;return null!=(t=e.name)?t:a.value},c=t.computed((()=>{const n=r()===i.currentName.value;return n&&!l.value&&(l.value=!0,i.props.lazyRender&&t.nextTick((()=>{i.onRendered(r(),e.title)}))),n})),s=t.ref(!c.value);return t.watch(c,(e=>{e?s.value=!1:y((()=>{s.value=!0}))})),t.watch((()=>e.title),(()=>{i.setLine(),i.scrollIntoView()})),t.provide(ut,c),()=>{var e;const r=`${i.id}-${a.value}`,{animated:u,swipeable:d,scrollspy:v,lazyRender:p}=i.props;if(!n.default&&!u)return;const f=v||c.value;if(u||d)return t.createVNode(pt,{id:o,role:"tabpanel",class:ht("panel-wrapper",{inactive:s.value}),tabindex:c.value?0:-1,"aria-hidden":!c.value,"aria-labelledby":r},{default:()=>{var e;return[t.createVNode("div",{class:ht("panel")},[null==(e=n.default)?void 0:e.call(n)])]}});const h=l.value||v||!p?null==(e=n.default)?void 0:e.call(n):null;return be({id:o}),t.withDirectives(t.createVNode("div",{id:o,role:"tabpanel",class:ht("panel"),tabindex:f?0:-1,"aria-labelledby":r},[h]),[[t.vShow,f]])}}})),bt=se(st),[wt,yt,xt]=oe("picker"),[Ct]=oe("picker-toolbar"),Nt={title:String,cancelButtonText:String,confirmButtonText:String};var Vt=t.defineComponent({name:Ct,props:Nt,emits:["confirm","cancel"],setup(e,{emit:n,slots:o}){const l=()=>n("cancel"),i=()=>n("confirm"),a=()=>{const n=e.cancelButtonText||xt("cancel");return t.createVNode("button",{type:"button",class:[yt("cancel"),re],onClick:l},[o.cancel?o.cancel():n])},r=()=>{const n=e.confirmButtonText||xt("confirm");return t.createVNode("button",{type:"button",class:[yt("confirm"),re],onClick:i},[o.confirm?o.confirm():n])};return()=>t.createVNode("div",{class:yt("toolbar")},[o.toolbar?o.toolbar():[a(),o.title?o.title():e.title?t.createVNode("div",{class:[yt("title"),"van-ellipsis"]},[e.title]):void 0,r()]])}});const[kt,St]=oe("picker-group"),Tt=Symbol(kt),$t=r({tabs:h()},Nt);t.defineComponent({name:kt,props:$t,emits:["confirm","cancel"],setup(e,{emit:n,slots:o}){const{children:l,linkChildren:i}=T(Tt);i();const a=()=>{n("confirm",l.map((e=>e.confirm())))},r=()=>n("cancel");return()=>{var n;const l=null==(n=o.default)?void 0:n.call(o);return t.createVNode("div",{class:St()},[t.createVNode(Vt,t.mergeProps(e,{onConfirm:a,onCancel:r}),null),t.createVNode(bt,{shrink:!0,class:St("tabs"),animated:!0},{default:()=>[e.tabs.map(((e,n)=>t.createVNode(gt,{title:e,titleClass:St("tab-title")},{default:()=>[null==l?void 0:l[n]]})))]})])}}});const Bt=r({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:m(44),showToolbar:p,swipeDuration:m(1e3),visibleOptionNum:m(6)},Ie),Ot=r({},Bt,{columns:h(),modelValue:h(),toolbarPosition:g("top"),columnsFieldNames:Object});console.log("%c 🍖 name","color:#42b983",de);const It=se(t.defineComponent({name:"BetterVantPicker",props:Ot,emits:["confirm","cancel","change","clickOption","update:modelValue"],setup(e,{emit:o,slots:l}){const i=t.ref(),a=t.ref(e.modelValue.slice(0)),{parent:c}=k(Tt),{children:s,linkChildren:v}=T($e);v();const p=t.computed((()=>function(e){return r({text:"text",value:"value",children:"children"},e)}(e.columnsFieldNames))),f=t.computed((()=>F(e.optionHeight))),h=t.computed((()=>function(e,t){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(t.children in n)return"cascade"}return"default"}(e.columns,p.value))),m=t.computed((()=>{const{columns:t}=e;switch(h.value){case"multiple":return t;case"cascade":return function(e,t,o){const l=[];let i={[t.children]:e},a=0;for(;i&&i[t.children];){const e=i[t.children],r=o.value[a];i=n(r)?ge(e,r,t):void 0,!i&&e.length&&(i=ge(e,fe(e)[t.value],t)),a++,l.push(e)}return l}(t,p.value,a);default:return[t]}})),g=t.computed((()=>m.value.some((e=>e.length)))),b=t.computed((()=>m.value.map(((e,t)=>ge(e,a.value[t],p.value))))),w=(e,t)=>{if(a.value[e]!==t){const n=a.value.slice(0);n[e]=t,a.value=n}},y=()=>({selectedValues:a.value.slice(0),selectedOptions:b.value}),x=()=>{s.forEach((e=>e.stopMomentum()));const e=y();return o("confirm",e),e},C=()=>o("cancel",y()),N=()=>m.value.map(((n,i)=>t.createVNode(Be,{value:a.value[i],fields:p.value,options:n,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:f.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:e=>((e,t)=>{w(t,e),"cascade"===h.value&&a.value.forEach(((e,t)=>{const n=m.value[t];me(n,e,p.value)||w(t,n.length?n[0][p.value.value]:void 0)})),o("change",r({columnIndex:t},y()))})(e,i),onClickOption:e=>((e,t)=>o("clickOption",r({columnIndex:t,currentOption:e},y())))(e,i)},{option:l.option}))),V=e=>{if(g.value){const n={height:`${f.value}px`},o={backgroundSize:`100% ${(e-f.value)/2}px`};return[t.createVNode("div",{class:ve("mask"),style:o},null),t.createVNode("div",{class:[ae,ve("frame")],style:n},null)]}},S=()=>{const n=f.value*+e.visibleOptionNum,o={height:`${n}px`};return t.createVNode("div",{ref:i,class:ve("columns"),style:o},[N(),V(n)])},$=()=>{if(e.showToolbar&&!c)return t.createVNode(Ae,t.mergeProps(u(e,Me),{onConfirm:x,onCancel:C}),u(l,ze))};let O;t.watch(m,(e=>{e.forEach(((e,t)=>{e.length&&!me(e,a.value[t],p.value)&&w(t,fe(e)[p.value.value])}))}),{immediate:!0}),t.watch((()=>e.modelValue),(e=>{d(e,a.value)||d(e,O)||(a.value=e.slice(0))}),{deep:!0}),t.watch(a,(t=>{d(t,e.modelValue)||(O=t.slice(0),o("update:modelValue",O))}),{immediate:!0}),B("touchmove",P,{target:i});return be({confirm:x,getSelectedOptions:()=>b.value}),()=>{var n,o;return t.createVNode("div",{class:ve()},["top"===e.toolbarPosition?$():null,e.loading?t.createVNode(Ve,{class:ve("loading")},null):null,null==(n=l["columns-top"])?void 0:n.call(l),S(),null==(o=l["columns-bottom"])?void 0:o.call(l),"bottom"===e.toolbarPosition?$():null])}}})),zt={install(e){e.component(It.name,It)}};e.BetterPicker=It,e.default=zt,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
